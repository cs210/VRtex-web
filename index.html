<!doctype html>
<html class="no-js" lang="">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" href="apple-touch-icon.png">

    <link rel="stylesheet" href="css/normalize.min.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/loader.css">
    <link href="http://fonts.googleapis.com/css?family=Orbitron:400,500" rel="stylesheet" type="text/css">

    <script src="js/jquery-1.11.2.min.js"></script>
    <script src="js/jquery-ui.min.js"></script>
    <script src="js/vendor/modernizr-2.8.3.min.js"></script>
    <script src="js/vendor/osc-browser.min.js"></script>
    <script src="js/svg.js"></script>
    <script src="http://127.0.0.1:8082/socket.io/socket.io.js"></script>

  </head>
  <body>
    <div class="bg"></div>
    <h1 class="text-center">GRAVITEAM</h1>
    <div class="shadow-separator"></div>
    <div class="body-wrap">
      <div class="row">

        <div class="control-panel col-lg-8" id="map-container">
          <div class="control-panel-monitor">
            <div class="position-wrap">
              <h4>ISS</h4>
              <div id="iss-container">
               <div id="helix">
                 <div class="container">
                  <span class="dots"></span>
                  <span class="dots"></span>
                  <span class="dots"></span>
                  <span class="dots"></span>
                  <span class="dots"></span>
                  <span class="dots"></span>
                  <span class="dots"></span>
                  <span class="dots"></span>
                  <span class="dots"></span>
                  <span class="dots"></span>
                  </div>
               </div>
                <!-- <div id="position-indicator" class="indicator"></div> -->
<!--                <object id="iss-svg" data="iss_floorplan-centered-withids-transparent.svg" type="image/svg+xml">-->
<!--                </object>-->
              </div>
            </div>
          </div>
        </div>

        <div class="control-panel col-lg-3" id="direction-container-outer">
          <div class="control-panel-monitor">
            <div class="navball-wrap">
              <h4>Direction</h4>
              <div id="direction-container">
                <div id="direction-indicator" class="indicator"></div>
                <object id="crosshair-svg" data="crosshair.svg" type="image/svg+xml">
                </object>
              </div>
            </div>

          </div></div>

        <div class="control-panel col-lg-3" id="speed-meter-outer">
          <div class="control-panel-monitor">
            <div class="speed-meter-wrap">
              <h4>Speed</h4>
              <div id="thrust-container">
                <div id="thrust-meter"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.11.2.min.js"><\/script>')</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r71/three.js"></script>
  <script src="http://threejs.org/examples/js/controls/TrackballControls.js"></script>

    <script type="text/javascript">
          var container;

      var camera, scene, renderer, controls;

      var mouseX = 0, mouseY = 0;

      var windowHalfX = window.innerWidth / 2;
      var windowHalfY = window.innerHeight / 2;

      var cx = -2500, cy = 2400;
      init();
      animate();


      function init() {

        container = document.getElementById( 'iss-container' );

        camera = new THREE.PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 1, 16000 );
        camera.position.z = 100;

        player = new THREE.Mesh(new THREE.SphereGeometry(5, 10, 10), new THREE.MeshBasicMaterial({color: 0xee0000}));
        // scene
        scene = new THREE.Scene();

//        var ambient = new THREE.AmbientLight( 0x404040 );
//        scene.add( ambient );
//        var hx = new THREE.HemisphereLight(0xffffff, 0x444444, 0.8)
//        scene.add(hx);
        scene.fog = new THREE.Fog(0x274297, 1200, 14000);

//        var directionalLight = new THREE.DirectionalLight( 0xffeedd );
//        directionalLight.position.set( 0, 0, 1 );
//        scene.add( directionalLight );


                // load ascii model
        var jsonLoader = new THREE.JSONLoader();
        jsonLoader.load( "ISS_JS.js", createScene );
        // load binary model
        console.log("Loading Mesh");
        function createScene( geometry, materials ) {
          console.log("LOADED!");

          $("#helix").hide("slow" ,function(){ $("#helix").remove(); } );

            var material = new THREE.MeshBasicMaterial({ color: 0xffffff, wireframe: true});
            material.opacity = 0.8;
            material.transparent = true;

            var mesh = new THREE.Mesh( geometry, material /*new THREE.MeshFaceMaterial( materials ) */);
            scene.add(mesh);
            scene.add(player);
             player.position = THREE.GeometryUtils.center(geometry);
            render();
        }

        controls = new THREE.TrackballControls( camera );
        controls.rotateSpeed = 1.0;
        controls.zoomSpeed = 1.2;
        controls.panSpeed = 0.8;

        controls.noZoom = false;
        controls.noPan = false;

        controls.staticMoving = true;
        controls.dynamicDampingFactor = 0.3;

        controls.keys = [ 65, 83, 68 ];
//        controls.target.lookAt( scene.position )


        controls.addEventListener( 'change', render );


        renderer = new THREE.WebGLRenderer({alpha: true, antialias: true});
        renderer.setClearColor( 0xffffff, 0);

        renderer.setPixelRatio( window.devicePixelRatio );
        renderer.setSize( container.clientWidth, 400 );
        container.appendChild( renderer.domElement)

        camera.position.x = cx;
        camera.position.y = cy;

//        document.addEventListener( 'mousemove', onDocumentMouseMove, false );

        //

        window.addEventListener( 'resize', onWindowResize, false );

      }

      function onWindowResize() {

        windowHalfX = container.clientWidth / 2;
        windowHalfY = 400 / 2;

        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();

//        renderer.setSize( window.innerWidth, window.innerHeight );

      }

      function onDocumentMouseMove( event ) {
        mouseX = ( event.clientX - windowHalfX - container.offsetLeft ) / 2;
        mouseY = ( event.clientY - windowHalfY - container.offsetTop ) / 2;
      }

      //

      function animate() {

        requestAnimationFrame( animate );
        //controls.update();
        render();
      }

      var radius = 3400;
      var t = 0;
      function render() {

        camera.position.x = scene.position.x + radius * Math.cos(t);
        camera.position.z = scene.position.z + radius * Math.sin(t);
        t += 0.007;
        camera.lookAt( scene.position );
        renderer.render( scene, camera );

      }


    </script>
    <script src="js/plugins.js"></script>
    <script src="js/main.js"></script>

  </body>
</html>
